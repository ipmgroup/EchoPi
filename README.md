# 1. –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è

**–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** –ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–Ω–∞—Ä –Ω–∞ –±–∞–∑–µ Raspberry Pi  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–∫—Ç–∏–≤–Ω—ã–π –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–∫–∞—Ç–æ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –≤–æ–∑–¥—É—à–Ω–æ–π –∏ –≤–æ–¥–Ω–æ–π —Å—Ä–µ–¥–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–æ–Ω–¥–∏—Ä—É—é—â–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Ç–∏–ø–∞ —á–∏—Ä–ø –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–µ –∏ –ë–ü–õ–ê/–ë–ü–ê, —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ –∞–≤—Ç–æ–ø–∏–ª–æ—Ç ArduPilot —á–µ—Ä–µ–∑ MAVLink.

# 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å:

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –∑–æ–Ω–¥–∏—Ä—É—é—â–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (–ª–∏–Ω–µ–π–Ω—ã–π/–Ω–µ–ª–∏–Ω–µ–π–Ω—ã–π —á–∏—Ä–ø)
- –ò–∑–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —á–µ—Ä–µ–∑ —É—Å–∏–ª–∏—Ç–µ–ª—å –∏ –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–π –∏–∑–ª—É—á–∞—Ç–µ–ª—å
- –ü—Ä–∏—ë–º –æ—Ç—Ä–∞–∂—ë–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞/–≥–∏–¥—Ä–æ—Ñ–æ–Ω–∞
- –¶–∏—Ñ—Ä–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–∞ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –æ—Ü–µ–Ω–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏, –∞–º–ø–ª–∏—Ç—É–¥—ã)
- –û—Ü–µ–Ω–∫—É –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –¥–æ —Ü–µ–ª–∏
- –ü–µ—Ä–µ–¥–∞—á—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ GUI –∏ MAVLink
- –†–∞–±–æ—Ç—É –≤ —Ä–µ–∂–∏–º–µ —Å–µ—Ä–≤–∏—Å–∞ (daemon)

# 3. –£—Å–ª–æ–≤–∏—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

## 3.1 –°—Ä–µ–¥–∞

- –í–æ–∑–¥—É—Ö
- –í–æ–¥–∞ (–ø—Ä–µ—Å–Ω–∞—è, –º–æ—Ä—Å–∫–∞—è ‚Äî –±–µ–∑ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —Å–æ–ª—ë–Ω–æ—Å—Ç–∏ –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ)

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ä–µ–¥—ã –¥–æ–ª–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ.

## 3.2 –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

- Raspberry Pi (5 / CM5, —É—Ç–æ—á–Ω—è–µ—Ç—Å—è)
- –û–°: Linux (Raspberry Pi OS / Ubuntu Server)

# 4. –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å

## 4.0 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ I2S-—É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø –ø—Ä–æ–µ–∫—Ç–∞)

–†–∞–±–æ—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è Raspberry Pi —Å I2S-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –∏ –æ—Ü–µ–Ω–∫–∏ –∏—Ö –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–¥–∞—á —Å–æ–Ω–∞—Ä–∞.

**–¶–µ–ª–∏ —ç—Ç–∞–ø–∞:**

- –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã I2S –Ω–∞ —á–∞—Å—Ç–æ—Ç–∞—Ö –¥–æ 50 –∫–ì—Ü —Å INMP441 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 48 –∫–ì—Ü);
- –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–µ—Ä–µ–¥–∞—á–∏ –∏ –ø—Ä–∏—ë–º–∞;
- —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ–ª–æ—Å—ã, —à—É–º–∞ –∏ –∑–∞–¥–µ—Ä–∂–µ–∫;
- –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏ MAX98357 –∏ INMP441 –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —ç—Ç–∞–ø–æ–≤;
- –æ—Ü–µ–Ω–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∑–≤—É–∫–æ–≤—ã—Ö –∫–∞—Ä—Ç –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ 96 –∫–ì—Ü –∏ –≤—ã—à–µ.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∞–ø–∞ —è–≤–ª—è—é—Ç—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–º Go / No-Go –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## 4.1 –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

- Raspberry Pi 4 / CM4
- –û–°: Linux (Raspberry Pi OS / Ubuntu Server)

## 4.2 –ê—É–¥–∏–æ—Ç—Ä–∞–∫—Ç (–Ω–∞—á–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø)

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** I2S

### 4.2.1 –ü–µ—Ä–µ–¥–∞—á–∞ (TX)

- I2S –¶–ê–ü —Å —É—Å–∏–ª–∏—Ç–µ–ª–µ–º: MAX98357
- –¢–∏–ø –∏–∑–ª—É—á–∞—Ç–µ–ª—è: –¥–∏–Ω–∞–º–∏–∫
- –†–µ–∂–∏–º: –º–æ–Ω–æ

### 4.2.2 –ü—Ä–∏—ë–º (RX)

- I2S –º–∏–∫—Ä–æ—Ñ–æ–Ω: INMP441
- –†–µ–∂–∏–º: –º–æ–Ω–æ
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:** 50 –∫–ì—Ü (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 48 –∫–ì—Ü)

### 4.2.3 –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—É–¥–∏–æ—Ç—Ä–∞–∫—Ç—É

- **–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:** 
  - –° INMP441: –º–∞–∫—Å–∏–º—É–º 50 –∫–ì—Ü (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 48 –∫–ì—Ü)
  - –° –¥—Ä—É–≥–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–æ 96 –∫–ì—Ü –∏ –≤—ã—à–µ
- –†–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å: —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å INMP441 –∏ MAX98357 (24 –±–∏—Ç–∞ I2S)
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏—ë–º–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∏
- –û–±—â–∏–π —Ç–∞–∫—Ç–æ–≤—ã–π –¥–æ–º–µ–Ω I2S (BCLK/LRCLK)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

- –ù–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –ø—Ä–∏—ë–º–∞ –∏ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–¥–∞—á–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∏—ë–º–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º

## 4.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ I2S –Ω–∞ Raspberry Pi 5

–í–ê–ñ–ù–û: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ I2S (Inter-IC Sound), –∞ –Ω–µ –∫ I2C.

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ MAX98357 (TX) –∏ INMP441 (RX):

–û–±—â–∏–µ I2S —Å–∏–≥–Ω–∞–ª—ã (–æ—Ç Pi –∫ –æ–±–æ–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º):
- BCLK (Bit Clock) ‚Üí GPIO 18
- LRCLK/WS (Word Select) ‚Üí GPIO 19
- DOUT (–æ—Ç INMP441 –∫ Pi) ‚Üí GPIO 20
- DIN (–æ—Ç Pi –∫ MAX98357) ‚Üí GPIO 21

MAX98357 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
- VIN ‚Üí 5V
- GND ‚Üí GND
- DIN ‚Üí GPIO 21 (PCM_DOUT)
- BCLK ‚Üí GPIO 18
- LRCLK ‚Üí GPIO 19

INMP441 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
- VDD ‚Üí 3.3V
- GND ‚Üí GND
- SD ‚Üí GPIO 20 (PCM_DIN)
- WS ‚Üí GPIO 19
- SCK ‚Üí GPIO 18
- L/R ‚Üí GND (–ª–µ–≤—ã–π –∫–∞–Ω–∞–ª)

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ /boot/firmware/config.txt:

–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞:

```
# I2S –∞—É–¥–∏–æ
dtparam=i2s=on

# MAX98357A DAC (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ)
dtoverlay=i2s-mmap
dtoverlay=googlevoicehat-soundcard
```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ googlevoicehat –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):

```
dtparam=i2s=on
dtoverlay=i2s-mmap
dtoverlay=hifiberry-dac
```

–î–ª—è INMP441 –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è:

```
dtoverlay=i2s-mmap
dtoverlay=rpi-simple-soundcard,card_name="inmp441"
```

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è config.txt:

```bash
sudo reboot
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É I2S
lsmod | grep snd

# –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
aplay -l

# –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∑–∞–ø–∏—Å–∏
arecord -l

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
cat /proc/asound/cards
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∫–∞—Ä—Ç—ã —Å –∏–º–µ–Ω–∞–º–∏ —Ç–∏–ø–∞ "googlevoicehat", "hifiberry", "inmp441" –∏–ª–∏ "bcm2835 I2S"
- –î–ª—è MAX98357: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (playback)
- –î–ª—è INMP441: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∏ (capture)

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–ª—è Raspberry Pi 5:
- –ù–∞ Pi 5 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ /boot/firmware/config.txt (–Ω–µ /boot/config.txt)
- Device tree overlays –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç Pi 4
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å 96 –∫–ì—Ü –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞—á–∞—Ç—å —Å 48 –∫–ì—Ü –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Pi 5 (48 –∫–ì—Ü):
```
dtparam=i2s=on
dtoverlay=i2s-mmap
dtoverlay=googlevoicehat-soundcard
```

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ—è–≤–∏—Ç—Å—è –∫–∞–∫: `snd_rpi_googlevoicehat_soundcar` (hw:0,0)
–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --sr 48000 –≤–æ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–∞—Ö.

–ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ loop-back: ~2.5 –º—Å –ø—Ä–∏ 48 –∫–ì—Ü.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Pi 5:**

**–í–∞–∂–Ω–æ:** INMP441 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 50 –∫–ì—Ü, –ø–æ—ç—Ç–æ–º—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π 96 –∫–ì—Ü –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–∞ –¥—Ä—É–≥—É—é –∑–≤—É–∫–æ–≤—É—é –∫–∞—Ä—Ç—É.

–í–∞—Ä–∏–∞–Ω—Ç 1 - Custom overlay (–¥–ª—è —á–∞—Å—Ç–æ—Ç –≤—ã—à–µ 50 –∫–ì—Ü —Å –¥—Ä—É–≥–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π):
```
dtparam=i2s=on
dtoverlay=i2s-mmap
dtoverlay=echopi-i2s-96k
```

–§–∞–π–ª overlay: `/boot/firmware/overlays/echopi-i2s-96k.dtbo`
–ò—Å—Ö–æ–¥–Ω–∏–∫: `echopi-i2s-96k.dts` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

Overlay –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `simple-audio-card` —Å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º I2S:
- `spdif-dit` (linux,spdif-dit) –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ MAX98357
- `spdif-dir` (linux,spdif-dir) –¥–ª—è –∑–∞–ø–∏—Å–∏ (–¥–ª—è INMP441 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 50 –∫–ì—Ü)
- –ë–µ–∑ –∂—ë—Å—Ç–∫–æ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ overlay

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ—è–≤–∏—Ç—Å—è –∫–∞–∫: `echopi-i2s` (hw:0,0)

–í–∞—Ä–∏–∞–Ω—Ç 2 - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π overlay (—Ç–æ–ª—å–∫–æ 48 –∫–ì—Ü):
```
dtparam=i2s=on
dtoverlay=i2s-mmap
dtoverlay=googlevoicehat-soundcard
```
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: `googlevoicehat` (hw:0,0) - —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 48 –∫–ì—Ü

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: 
- **INMP441** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º **50 –∫–ì—Ü** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **48 –∫–ì—Ü**)
- MAX98357 –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö —á–∞—Å—Ç–æ—Ç–∞—Ö
- –î–ª—è —á–∞—Å—Ç–æ—Ç –≤—ã—à–µ 50 –∫–ì—Ü –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∞ INMP441 –Ω–∞ –¥—Ä—É–≥—É—é –∑–≤—É–∫–æ–≤—É—é –∫–∞—Ä—Ç—É
- googlevoicehat-soundcard –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 48 –∫–ì—Ü –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥—Ä–∞–π–≤–µ—Ä–∞
- audioinjector-bare-i2s –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤—ã—Ö–æ–¥ (out=8, in=0)
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è overlay —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞: `sudo reboot`

–î–ª—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ overlay:
```bash
cd /home/pi/src/EchoPi5
dtc -@ -I dts -O dtb -o echopi-i2s-96k.dtbo echopi-i2s-96k.dts
sudo cp echopi-i2s-96k.dtbo /boot/firmware/overlays/
sudo reboot
```

# 5. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## 5.1 –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ –≤–∏–¥–µ —Å–µ—Ä–≤–∏—Å–∞ –∏ –≤–∫–ª—é—á–∞–µ—Ç:

- –ú–æ–¥—É–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ú–æ–¥—É–ª—å –ø—Ä–∏—ë–º–∞ –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
- –ú–æ–¥—É–ª—å —Ü–∏—Ñ—Ä–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ (DSP)
- –ú–æ–¥—É–ª—å –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ü–µ–ª–∏
- –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- GUI

## 5.2 –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

- –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π (–ø–æ —Ç–∞–π–º–µ—Ä—É)
- –ü–æ –∫–æ–º–∞–Ω–¥–µ (GUI / MAVLink)

## 5.3 –¶–µ–ª—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –¶–µ–ª—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–û–±–µ—Å–ø–µ—á–∏—Ç—å:

- –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π RX-—Å—Ç—Ä–∏–º
- —Ç–æ—á–Ω—É—é –ø—Ä–∏–≤—è–∑–∫—É –º–æ–º–µ–Ω—Ç–∞ TX
- —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞–ª—å–Ω–æ—Å—Ç–∏
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ—Å–ª–µ —Ñ–∞–∫—Ç–∞
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π –≤ callback
- —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ jitter / XRUN

### 2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –Ω–∞–±–æ—Ä –±—É—Ñ–µ—Ä–æ–≤

### –§–ò–ó–ò–ß–ï–°–ö–ò–ï (—Ä–µ–∞–ª—å–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã)

#### 1Ô∏è‚É£ RX Ring Buffer (–≥–ª–∞–≤–Ω—ã–π)

- **1 —à—Ç**, –∫–æ–ª—å—Ü–µ–≤–æ–π
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
  - –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∑–∞–ø–∏—Å—å RX
  - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- **–†–∞–∑–º–µ—Ä:**
  - `N_ring ‚â• 2 √ó (N_chirp + N_echo)`
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
  - `N_ring = power_of_two(2 √ó (N_chirp + N_echo))`
- **–¢–∏–ø:**
  - `numpy.ndarray`
  - `float32`
  - mono (–∏–ª–∏ `[N_ring, channels]`)

#### 2Ô∏è‚É£ TX FIFO Buffer

- **1 —à—Ç**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
  - –ø–æ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ outdata callback
  - decouple control ‚Üî audio thread
- **–†–∞–∑–º–µ—Ä:**
  - `N_chirp + 2 √ó blocksize`
- **–¢–∏–ø:**
  - ring buffer –∏–ª–∏ FIFO
  - `float32`

#### 3Ô∏è‚É£ TX Chirp Reference

- **1 —à—Ç**, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
  - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è TX FIFO
  - —ç—Ç–∞–ª–æ–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- **–†–∞–∑–º–µ—Ä:**
  - `N_chirp`

### –õ–û–ì–ò–ß–ï–°–ö–ò–ï (view / –≤—Ä–µ–º–µ–Ω–Ω—ã–µ)

#### 4Ô∏è‚É£ Correlation Window

- –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä
- slice –∏–∑ RX Ring Buffer
- **–¥–ª–∏–Ω–∞:**
  - `N_corr = N_chirp + N_echo`

#### 5Ô∏è‚É£ Correlation Output

- –≤—Ä–µ–º–µ–Ω–Ω—ã–π
- FFT —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–≤—è–∑–µ–π (—Å—Ö–µ–º–∞)

```
            TX Chirp Reference
                     ‚îÇ
                     ‚ñº
                TX FIFO Buffer
                     ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         sounddevice duplex callback        ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ  RX ‚Üí RX Ring Buffer                      ‚îÇ
‚îÇ  TX ‚Üê TX FIFO                             ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ  —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è tx_sample_index              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
           RX Ring Buffer (history)
                      ‚îÇ
             Correlation Window
                      ‚îÇ
               FFT Correlation
```

### 4. –¢–∞–π–º–∏–Ω–≥ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è (–ö–õ–Æ–ß–ï–í–û–ï)

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏

- `rx_sample_counter`  # –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Å—ç–º–ø–ª–æ–≤
- `tx_sample_index`    # –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–≥–æ TX —Å—ç–º–ø–ª–∞

### –í audio callback

```python
def callback(indata, outdata, frames, time, status):
    global rx_write_idx, rx_sample_counter

    # RX
    ring[rx_write_idx:rx_write_idx+frames] = indata[:, 0]
    rx_write_idx = (rx_write_idx + frames) % N_ring
    rx_sample_counter += frames

    # TX
    outdata[:, 0] = tx_fifo.read(frames)

    if tx_started_now:
        tx_sample_index = rx_sample_counter
```

üìå **`tx_sample_index`** ‚Äî –Ω—É–ª–µ–≤–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å.

### 5. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–∫–Ω–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

**–ö–æ–≥–¥–∞:**
- `rx_sample_counter >= tx_sample_index + N_corr`

**–¢–æ–≥–¥–∞:**
```python
start = tx_sample_index % N_ring
end   = (start + N_corr) % N_ring

if start < end:
    rx_window = ring[start:end]
else:
    rx_window = np.concatenate((ring[start:], ring[:end]))
```

### 6. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è

- —ç—Ç–∞–ª–æ–Ω: `chirp_tx[::-1]`
- RX –æ–∫–Ω–æ: `N_chirp + N_echo`
- FFT –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
- blank zone: `0‚Ä¶N_chirp`

### 7. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä–∏–º–∞ / –º—É–ª—å—Ç–∏-–ø–∏–Ω–≥

### –û—á–µ—Ä–µ–¥—å TX —Å–æ–±—ã—Ç–∏–π

```python
tx_events = deque()
tx_events.append(tx_sample_index)
```

**DSP-–ø–æ—Ç–æ–∫:**
- –±–µ—Ä—ë—Ç —Å–ª–µ–¥—É—é—â–∏–π `tx_sample_index`
- –∂–¥—ë—Ç –¥–∞–Ω–Ω—ã—Ö
- –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
- —É–¥–∞–ª—è–µ—Ç

### 8. –ü–æ—Ç–æ–∫–∏ (—Å—Ç—Ä–æ–≥–æ)

| –ü–æ—Ç–æ–∫ | –î–µ–ª–∞–µ—Ç |
|-------|--------|
| sounddevice callback | RX/TX –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ |
| Control | –∑–∞–ø—É—Å–∫ TX |
| DSP | –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è |

‚ùå –ù–∏–∫–∞–∫–æ–π DSP –≤ callback  
‚ùå –ù–∏–∫–∞–∫–∏—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ callback

### 9. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è sounddevice

```python
sd.Stream(
    samplerate=Fs,
    blocksize=256,
    channels=1,
    dtype='float32',
    latency='low',
    callback=callback
)
```

### 10. –ü–æ—á–µ–º—É —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

- RX ring –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç chirp + –≤–µ—Å—å —ç—Ö–æ—Å–∏–≥–Ω–∞–ª
- –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- –Ω–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å pipeline
- –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ multi-ping

### 11. –ü—Ä–∏–º–µ—Ä

### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–°—Ä–µ–¥–∞:** –≤–æ–∑–¥—É—Ö

**–°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞:**
- `c ‚âà 343 –º/—Å`

**–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:**
- `Fs = 48 000 –ì—Ü`

**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å chirp:**
- `T_chirp = 50 –º—Å = 0.05 —Å`

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è:**
- `R_max = 10 –º`

### 1. –†–∞—Å—á—ë—Ç –≤—Ä–µ–º—ë–Ω

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏—Ö–æ–¥–∞ —ç—Ö–∞:**
```
T_echo = (2 √ó R_max) / c = 20 / 343 ‚âà 0.0583 —Å = 58.3 –º—Å
```

**–ü–æ–ª–Ω–æ–µ –æ–∫–Ω–æ –æ–¥–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è:**
```
T_corr = T_chirp + T_echo ‚âà 0.05 + 0.0583 = 0.1083 —Å
```

### 2. –†–∞—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –æ—Ç—Å—á—ë—Ç–∞—Ö

**Chirp:**
```
N_chirp = Fs √ó T_chirp = 48 000 √ó 0.05 = 2400 samples
```

**–≠—Ö–æ:**
```
N_echo = Fs √ó T_echo = 48 000 √ó 0.0583 ‚âà 2800 samples
```

**–û–∫–Ω–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–ú–ò–ù–ò–ú–£–ú):**
```
N_corr = N_chirp + N_echo = 2400 + 2800 = 5200 samples
```

### 3. RX Ring Buffer ‚Äî –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä

**–ú–∏–Ω–∏–º—É–º (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- `RX_ring ‚â• 5200 + 2√óblocksize`
- –ü—Ä–∏ `blocksize = 256`: ‚âà 5712

**–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):**
```
RX_ring = power_of_two(2 √ó N_corr)
        = 2 √ó 5200 = 10400
        ‚Üí 16384
```

‚úÖ **–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ:**
- **RX Ring Buffer = 16384 samples**
- (‚âà 341 –º—Å –∏—Å—Ç–æ—Ä–∏–∏)

### 4. –û—Å—Ç–∞–ª—å–Ω—ã–µ –±—É—Ñ–µ—Ä—ã

**TX Chirp Reference:**
- `N_chirp = 2400 samples`

**TX FIFO Buffer:**
```
TX_FIFO ‚â• N_chirp + 2√óblocksize
        = 2400 + 512
        = 2912
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º:**
- `TX_FIFO = 4096 samples`

### 5. –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ß–ò–°–õ–ê)

#### –§–∏–∑–∏—á–µ—Å–∫–∏–µ –±—É—Ñ–µ—Ä—ã (3)

| –ë—É—Ñ–µ—Ä | –†–∞–∑–º–µ—Ä (samples) |
|-------|------------------|
| RX Ring Buffer | 16384 |
| TX FIFO | 4096 |
| TX Chirp Reference | 2400 |

#### –õ–æ–≥–∏—á–µ—Å–∫–∏–µ

| –ë—É—Ñ–µ—Ä | –†–∞–∑–º–µ—Ä |
|-------|--------|
| Correlation Window | 5200 |
| FFT buffer | ‚â• 8192 |

### 6. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–∏–Ω–≥–∞–º–∏

```
T_ping ‚â• T_corr ‚âà 108 –º—Å
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
- `T_ping ‚âà 120‚Äì150 –º—Å`

### 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥—Ä–∞–≤–æ–≥–æ —Å–º—ã—Å–ª–∞

- RX ring –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç 1.5√ó –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ ‚úÖ
- blocksize (256) –≤–ª–µ–∑–∞–µ—Ç —Å –∑–∞–ø–∞—Å–æ–º ‚úÖ
- –¥–∞–ª—å–Ω–∏–µ —Ü–µ–ª–∏ (10 –º) –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è ‚úÖ
- —Å—Ç—Ä–∏–º –±–µ–∑ –≥–æ–Ω–æ–∫ –∏ overwrite ‚úÖ

# 6. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

## 6.1 –ó–æ–Ω–¥–∏—Ä—É—é—â–∏–π —Å–∏–≥–Ω–∞–ª

- **–¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞:** –ª–∏–Ω–µ–π–Ω—ã–π —á–∞—Å—Ç–æ—Ç–Ω–æ-–º–æ–¥—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–∏—Ä–ø (LFM)
- **–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:** 
  - –° INMP441: –º–∞–∫—Å–∏–º—É–º 50 –∫–ì—Ü (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 48 –∫–ì—Ü)
  - –° –¥—Ä—É–≥–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π: –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–æ 96 –∫–ì—Ü –∏ –≤—ã—à–µ
- **–ü–æ–ª–æ—Å–∞ —Å–∏–≥–Ω–∞–ª–∞ B** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

- –î–∞–ª—å–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑–ª—É—á–∞–µ–º–æ–π –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø—Ä–∏—ë–º–Ω–∏–∫–∞
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–æ—Å–æ–π —á–∏—Ä–ø–∞

**–û—Ü–µ–Ω–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ –¥–∞–ª—å–Ω–æ—Å—Ç–∏:**

```
ŒîR = c / (2 ¬∑ B)
```

–≥–¥–µ:
- `c` ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ —Å—Ä–µ–¥–µ
- `B` ‚Äî –ø–æ–ª–æ—Å–∞ —á–∏—Ä–ø–∞

## 6.2 –°–≤—è–∑—å —á–∞—Å—Ç–æ—Ç—ã –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–ª–æ—Å—ã

- –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ —á–µ–º –≤ 2 —Ä–∞–∑–∞ –≤—ã—à–µ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–æ—Ç—ã —á–∏—Ä–ø–∞ (Nyquist)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è oversampling √ó2‚Ä¶√ó4 –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ

**–ü—Ä–∏–º–µ—Ä—ã:**

- `Fs = 48 –∫–ì—Ü` (INMP441 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚Üí —Ä–∞–±–æ—á–∞—è –ø–æ–ª–æ—Å–∞ –¥–æ ~20 –∫–ì—Ü
- `Fs = 96 –∫–ì—Ü` (—Å –¥—Ä—É–≥–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π) ‚Üí —Ä–∞–±–æ—á–∞—è –ø–æ–ª–æ—Å–∞ –¥–æ ~40 –∫–ì—Ü
- `Fs = 192 –∫–ì—Ü` (—Å –¥—Ä—É–≥–æ–π –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π) ‚Üí —Ä–∞–±–æ—á–∞—è –ø–æ–ª–æ—Å–∞ –¥–æ ~80 –∫–ì—Ü

## 6.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–∞

- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ª–æ—Å–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π
- –û–∫–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø—Ä–∏–Ω—è—Ç–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ —Å –æ–ø–æ—Ä–Ω—ã–º (FFT-based)
- Zero-padding –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ—Ü–µ–Ω–∫–∏ –∑–∞–¥–µ—Ä–∂–∫–∏
- –ü–æ–∏—Å–∫ –º–∞–∫—Å–∏–º—É–º–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- Sub-sample –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–∏–∫–∞ (–ø–∞—Ä–∞–±–æ–ª–∞ / sinc)

## 6.4 –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–∏–æ–¥–∞ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- Python –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –î–ª—è Fs ‚â• 192 –∫–ì—Ü –∏ –¥–ª–∏–Ω–Ω—ã—Ö —á–∏—Ä–ø–æ–≤ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–Ω–æ—Å DSP –≤ C++/Rust

# 7. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

## 7.1 GUI

–õ–æ–∫–∞–ª—å–Ω—ã–π GUI (Qt / Web / —É—Ç–æ—á–Ω—è–µ—Ç—Å—è)

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**

- –°—ã—Ä–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –û—Ü–µ–Ω–∫–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
- –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —á–∏—Ä–ø–∞

## 7.2 MAVLink / ArduPilot

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**

- –ü–µ—Ä–µ–¥–∞—á–∏ –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ (–∞–Ω–∞–ª–æ–≥ DISTANCE_SENSOR)
- –ü–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã

# 8. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–∑–∞–¥–µ—Ä–∂–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ < X –º—Å)
- –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–º–∞—Å—Å–∏–≤ –¥–∞—Ç—á–∏–∫–æ–≤, –¥—Ä—É–≥–∏–µ —Å–∏–≥–Ω–∞–ª—ã)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

# 9. –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ –≤—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–Ω–æ–π –±–∞–∑—ã
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∏—ë–º–∞
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DSP –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è GUI
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è MAVLink
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤–æ–∑–¥—É—Ö–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤–æ–¥–µ

# 10. –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

- –ß–∞—Å—Ç–æ—Ç–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑–ª—É—á–∞—Ç–µ–ª—è
- –¢–∏–ø –¥–∏–Ω–∞–º–∏–∫–∞ / –≥–∏–¥—Ä–æ—Ñ–æ–Ω–∞
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∞—è –º–æ—â–Ω–æ—Å—Ç—å
- –¢—Ä–µ–±—É–µ–º–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å –≤ –≤–æ–∑–¥—É—Ö–µ –∏ –≤–æ–¥–µ
- –î–æ–ø—É—Å—Ç–∏–º–∞—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

# 11. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞ (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–∞—Ä–∫–∞—Å)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
- src/echopi ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
	- config.py ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∞—É–¥–∏–æ –∏ —á–∏—Ä–ø–∞
	- cli.py ‚Äî CLI-—É—Ç–∏–ª–∏—Ç—ã
	- settings.py ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (—Å–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã GUI)
	- dsp/chirp.py ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–æ–Ω–¥–∏—Ä—É—é—â–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
	- dsp/correlation.py ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–∏–∫–∞
	- dsp/tone.py ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç–æ–Ω–æ–≤
	- io/audio.py ‚Äî –æ–±—ë—Ä—Ç–∫–∏ –Ω–∞–¥ sounddevice (I2S/ALSA)
	- io/audio_safe.py ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è –∞—É–¥–∏–æ-–ø–æ—Ç–æ–∫–∞
	- utils/latency.py ‚Äî –∏–∑–º–µ—Ä–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ‚Üí–∑–∞–ø–∏—Å—å
	- utils/distance.py ‚Äî –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —Ü–µ–ª–∏
	- gui/scope.py ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ+—Å–ø–µ–∫—Ç—Ä
	- gui/sonar.py ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π GUI —Å–æ–Ω–∞—Ä–∞
- requirements.txt ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (numpy, scipy, sounddevice, soundfile, pyqtgraph)
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
sudo apt-get install libportaudio2 libsndfile1
python -m venv .venv && source .venv/bin/activate
pip install -e .
```

## CLI (–ø–æ—Å–ª–µ pip install -e .): echopi <–∫–æ–º–∞–Ω–¥–∞>

- `devices` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ALSA/I2S
- `generate-chirp out.wav [--sr 48000 --start 2000 --end 20000 --duration 0.05 --amp 0.8]`
- `play file.wav [--play-device <id> --sr 48000]`
- `tone [--freq 1000 --seconds 1 --amp 0.8 --play-device <id> --sr 48000]` ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∏–Ω—É—Å
- `record out.wav [--seconds 5 --rec-device <id> --sr 48000]`
- `monitor [--rec-device <id> --sr 48000]` ‚Äî –æ–Ω–ª–∞–π–Ω RMS –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- `scope [--rec-device <id> --sr 48000]` ‚Äî –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ+—Å–ø–µ–∫—Ç—Ä (pyqtgraph)
- `check-device [--play-device <id> --rec-device <id> --sr 48000]` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `latency [--play-device <id> --rec-device <id> --sr 48000 --start 2000 --end 20000 --duration 0.05 --amp 0.8]`
- `distance [--play-device <id> --rec-device <id> --sr 48000 --medium air|water --sys-latency 0.001357]` ‚Äî –∏–∑–º–µ—Ä–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏

## –ö–∞–∫ –º–µ—Ä–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É I2S

1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å MAX98357 (TX) –∏ INMP441 (RX) –∫ –æ–±—â–µ–º—É BCLK/LRCLK.
2. –í—ã–±—Ä–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: `echopi devices`.
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å: `echopi latency --play-device <TX> --rec-device <RX> --sr 48000`.
4. –ö–æ–º–∞–Ω–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–∏—Ä–ø, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –µ–≥–æ –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–∏—à–µ—Ç –∑–≤—É–∫; –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.

## –ö–∞–∫ –∏–∑–º–µ—Ä–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –æ–±—ä–µ–∫—Ç–∞

1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å MAX98357 (TX) –∏ INMP441 (RX) –∫ –æ–±—â–µ–º—É BCLK/LRCLK.
2. –ù–∞–ø—Ä–∞–≤–∏—Ç—å –¥–∏–Ω–∞–º–∏–∫ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–∞ —Ü–µ–ª—å.
3. –ò–∑–º–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É: `echopi latency --play-device 0 --rec-device 0 --sr 48000`
4. –ò–∑–º–µ—Ä–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: `echopi distance --play-device 0 --rec-device 0 --sr 48000 --medium air --sys-latency 0.001357`
5. –î–ª—è –≤–æ–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--medium water`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –∏–∑–º–µ—Ä–µ–Ω–∏—é —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è:**

- –≠—Ç–∞–ª–æ–Ω–Ω—ã–π —á–∏—Ä–ø —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å –æ–∫–Ω–æ–º (Tukey —á–µ—Ä–µ–∑ fade_fraction) - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –±–æ–∫–æ–≤—ã—Ö –ª–µ–ø–µ—Å—Ç–∫–æ–≤
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å —Ç–µ–º –∂–µ —á–∏—Ä–ø–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∏–∑–ª—É—á–µ–Ω
- –°–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ –¥–∞–ª—å–Ω–æ—Å—Ç–∏: `ŒîR = c / (2B)`, –≥–¥–µ B - –ø–æ–ª–æ—Å–∞ —á–∏—Ä–ø–∞
  - –í–æ–∑–¥—É—Ö (2-20 –∫–ì—Ü): ~9.5 –º–º
  - –í–æ–¥–∞ (2-20 –∫–ì—Ü): ~41 –º–º
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (~23 —Å–º –≤ –≤–æ–∑–¥—É—Ö–µ, ~100 —Å–º –≤ –≤–æ–¥–µ)
- SNR —É–ª—É—á—à–∞–µ—Ç—Å—è —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–∏—Ä–ø–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50 –º—Å)

## –ö–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω –æ–Ω–ª–∞–π–Ω

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å: `python -m echopi.cli monitor --rec-device <RX> --sr 48000`.
2. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è RMS; –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —à—É–º–∞/–ø–æ–ª–æ—Å—ã.

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (pyqtgraph)

1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ PyQt5/pyqtgraph (`pip install -e .` —É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç).
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å: `echopi scope --rec-device <RX> --sr 48000`.
3. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ —Å –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–æ–º (–≤–æ–ª–Ω–∞) –∏ —Å–ø–µ–∫—Ç—Ä–æ–º (FFT) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## –ö–∞–∫ –ø—Ä–æ–∏–≥—Ä–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–∏—Ä–ø: `python -m echopi.cli generate-chirp chirp.wav --sr 48000`.
2. –ü—Ä–æ–∏–≥—Ä–∞—Ç—å: `python -m echopi.cli play chirp.wav --play-device <TX>`.

## –ó–∞–º–µ—Ç–∫–∏

- I2S-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ ALSA (—Å–º. `arecord -l` / `aplay -l`) –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ sounddevice –ø–æ –∏–Ω–¥–µ–∫—Å—É –∏–ª–∏ –∏–º–µ–Ω–∏.
- `frames_per_buffer` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2048; —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É, –Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ XRUN.
- –î–ª—è —á–∞—Å—Ç–æ—Ç 192 –∫–ì—Ü –≤–∞–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –Ω—É–∂–Ω—ã–π BCLK.